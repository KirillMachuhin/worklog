<!DOCTYPE html>
<html>
    <head>
        <!-- revision: {{ git_revision }} -->
        <title>{% block title %}DoneCal - Remembering what you've done{% end %}</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="Shortcut Icon" href="{{ static_url("images/favicon.ico") }}" type="image/x-icon">
        {{ modules.Static("css/style.css", "css/jquery.fancybox-1.3.1.css") }}
	<style type="text/css">
        #login {
          {% if user %}
          background-image:url('{{ static_url("images/locked.gif") }}');
          {% else %}
          background-image:url('{{ static_url("images/key.gif") }}');
          {% end %}
        }
	</style>
        {% block extra_head %}{% end %}
    </head>
    <body class="content-sidebar">
    <div id="login">
      {% if user %}
      <p><a href="/user/account/" class="account">Hi {{ user_name }}</a>
      <a href="/auth/logout/" class="log-out">log out</a></p>
      {% else %}
      <p><a href="/user/account/" class="account">Login &amp; registration</a></p>
      {% end %}
    </div>
    
    <div id="wrap">
    
      <!--
      <div id="header">
        <div class="wrap">
	  <h1 id="title">DoneCal</h1>
	</div>
      </div>
      -->
      
      <div id="inner">
        <div id="content-sidebar-wrap">
	  <div id="content">
            {% block content %}
            <div id="content_inner">
            {% block content_inner %}
            {% end %}
            </div>
            {% end %}
	  </div>
	  <div id="sidebar" class="widget-area">
            {% block sidebar %}{% end %}
	  </div>
	</div>
      </div>
      
      
      <div id="footer">
        <div class="wrap">
	  <div class="creds">
            <p class="footer-stats">
              Current total of events across all accounts: <span id="total_no_events">{{ total_no_events }}</span>
            </p>
	    {{ modules.Footer() }}
	  </div>
	</div>
      </div>
      
      
    </div>


{{ modules.Settings(settings) }}

<!-- basics needed to render the calendar -->
{% block corejs %}
{{ modules.Static("ext/jquery-1.4.2.min.js", "ext/jquery.fancybox-1.3.1.pack.js") }}
{% end %}

<script type="text/javascript">
function L() {
   if (window.console && window.console.log)
   for (var i = 0, l = arguments.length; i < l; i++)
     console.log(arguments[i]);
}

var total_no_events = {{ total_no_events }};
function increment_total_no_events(new_no) {
  total_no_events += typeof new_no != 'undefined' ? new_no : 1;
  $('#total_no_events').text(total_no_events);
}

function decrement_total_no_events(new_no) {
  total_no_events -= typeof new_no != 'undefined' ? new_no : 1;
  $('#total_no_events').text(total_no_events);
}

$(function() {
  $('a.account').fancybox({
         'autoDimensions': false,
         'width'         : 500,
         'height'        : 400,
         'transitionIn': 'none',
         'transitionOut': 'none',
         onComplete: function(array, index, opts) {
            $.getScript(JS_URLS.account);
         }
   });
});      
</script>

{% block extrajs %}{% end %}

    </body>
</html>
